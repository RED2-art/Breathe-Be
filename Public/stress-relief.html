<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8" />
  <title>Relieving Stress | Breathe & Be</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* CSS is unchanged */
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: linear-gradient(to right, #ffe680, #cce5ff);
      color: #003366;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      visibility: hidden; 
    }

    nav {
      display: flex; 
      flex-wrap: wrap; 
      gap: 12px;
      justify-content: center;
      align-items: center;
      padding: 12px 15px;
      border-radius: 16px;
      margin-bottom: 30px;
      position: sticky; top: 15px; z-index: 100;
      width: 100%;
      max-width: 1100px;
      background: rgba(255, 255, 255, 0.65);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
    }
    nav a { 
      text-decoration: none; 
      font-weight: 600; 
      color: #004085; 
      background: rgba(227, 242, 253, 0.8); 
      padding: 8px 14px; 
      border-radius: 8px; 
      transition: all 0.3s ease; 
      white-space: nowrap; 
      display: inline-flex; 
      align-items: center; 
      justify-content: center; 
    }
    nav a:hover { background-color: #bbdefb; color: #00264d; transform: translateY(-2px); }
    nav a[aria-current="page"] { background: #1976d2; color: white; transform: none; }
    nav a.home-icon { padding: 8px 10px; }

    .profile-menu { position: relative; }
    #profile-menu-button { background-color: #004085; color: white; border: 2px solid white; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; display: flex; align-items: center; justify-content: center; padding: 0; transition: background-color 0.3s; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
    #profile-menu-button:hover { background-color: #0059b3; }
    #profile-menu-dropdown { display: none; position: absolute; right: 0; top: calc(100% + 10px); background: white; border-radius: 8px; box-shadow: 0 5px 25px rgba(0,0,0,0.15); min-width: 220px; z-index: 101; overflow: hidden; }
    #profile-menu-dropdown.show { display: block; }
    .profile-header { padding: 15px; background-color: #f8f9fa; border-bottom: 1px solid #dee2e6; }
    .profile-header p { margin: 0; font-weight: 600; color: #343a40; font-size: 0.9rem; word-break: break-all; }
    .dropdown-item { display: flex; align-items: center; gap: 10px; padding: 12px 15px; color: #343a40; text-decoration: none; font-weight: 500; transition: background-color 0.2s; font-size: 0.95rem; }
    .dropdown-item:hover { background-color: #f1f3f5; }
    .dropdown-divider { height: 1px; background-color: #e9ecef; margin: 5px 0; }

    h1, h2, h3 { font-family: 'Poppins', sans-serif; }
    h1 { font-size: 3rem; text-align: center; }
    p { text-align: center; max-width: 700px; line-height: 1.6; }
    
    .habit-card { 
      width: 100%; 
      max-width: 700px; 
      padding: 30px; 
      margin-bottom: 30px; 
      text-align: left; 
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.25);
      box-shadow: 0 8px 32px 0 rgba(0, 51, 102, 0.1);
    }
    .habit-card h3 { margin-top: 0; color: #004085; }
    .habit-card p { text-align: left; }
    label { font-weight: 600; color: #004085; }
    
    input[type="text"] { 
      width: 100%; 
      padding: 12px; 
      margin-top: 8px; 
      margin-bottom: 15px; 
      border-radius: 10px; 
      border: 1px solid rgba(206, 212, 218, 0.8);
      font-size: 1rem; 
      box-sizing: border-box; 
      font-family: inherit;
      background-color: rgba(255, 255, 255, 0.7);
    }
    input[type="text"]:focus { 
      border-color: #42a5f5; 
      outline: none; 
      box-shadow: 0 0 8px rgba(144, 202, 249, 0.5); 
      background-color: white;
    }
    
    input[type="range"] { width: 100%; margin-top: 8px; }
    .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; margin-top: 15px; padding: 12px 24px; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; font-family: 'Poppins', sans-serif; transition: all 0.3s ease; }
    .btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15); }
    .btn:disabled { background: #dee2e6; cursor: not-allowed; }
    .btn-primary { background: linear-gradient(135deg, #64b5f6, #42a5f5); color: white; }
    .btn-primary:hover:not(:disabled) { background: linear-gradient(135deg, #90caf9, #64b5f6); }
    
    .interactive-text { 
      margin-top: 20px; 
      font-size: 1rem; 
      line-height: 1.5; 
      background: rgba(227, 242, 253, 0.7);
      border: 1px solid rgba(144, 202, 249, 0.5);
      padding: 15px; 
      border-radius: 8px; 
    }
    #exerciseInstructions { margin-top: 20px; font-weight: 600; font-size: 1.1rem; color: #004085; }
    #countdown { font-size: 2rem; font-weight: 700; color: #003366; margin-top: 10px; }
    footer { margin-top: auto; padding: 15px; font-size: 0.9rem; color: #666; text-align: center; width: 100%; max-width: 900px; }
  </style>
</head>
<body>

  <nav>
    <a href="HomePage.html" class="home-icon" aria-label="Home">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
        <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z"/>
      </svg>
    </a>
    <a href="VentMachine.html">Vent Machine</a>
    <a href="procrastination.html">Procrastination</a>
    <a href="ted-talks.html">TED Talks</a>
    <a href="leaderboard.html">üèÜ Leaderboard</a>
    <a href="reach-out.html">Reach Out</a>
    <a href="positive-mindset.html">Positive Mindset</a>
    <a href="stress-relief.html" aria-current="page">Stress Relief</a>
    
    <div class="profile-menu">
      <button id="profile-menu-button" aria-label="Open user menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.57 10 8 10c-2.57 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/></svg>
      </button>
      <div id="profile-menu-dropdown">
        <div class="profile-header">
          <p id="user-email-display">Loading...</p>
        </div>
        <a href="settings.html" class="dropdown-item">Settings</a>
        <div class="dropdown-divider"></div>
        <a href="#" class="dropdown-item" id="sign-out-button">Sign Out</a>
      </div>
    </div>
  </nav>

  <h1>Stress Relief</h1>
  <p>These simple habits are recommended by psychologists to help you feel more in control, calm, and confident ‚Äî even on stressful days.</p>
  <div id="mindsetList">
    <div class="habit-card">
      <h3>üß† Thought Tracker</h3>
      <p>Identify what's stressing you right now, then rate how intense it feels on a scale from 1 to 10.</p>
      <label for="stressThought">What's on your mind?</label><br/>
      <input type="text" id="stressThought" placeholder="Type your main stressor here" />
      <label for="stressRating">Rate your stress level:</label><br/>
      <input type="range" id="stressRating" min="1" max="10" value="5" />
      <span id="stressRatingValue" style="font-weight: 600; color: #004085; margin-left: 8px;">5</span>
      <button id="submitThoughtBtn" class="btn btn-primary">Submit</button>
      <div class="interactive-text" id="thoughtResult" style="display: none;"></div>
    </div>
    <div class="habit-card">
      <h3>üå¨Ô∏è Box Breathing</h3>
      <p>Breathe in slowly for 4 seconds, hold your breath for 4 seconds, breathe out slowly for 4 seconds, then hold again for 4 seconds. Repeat for 4 cycles.</p>
    </div>
    <div class="habit-card">
      <h3>üí™ Progressive Muscle Relaxation</h3>
      <p>Tense each muscle group for 5 seconds, then relax for 10 seconds. Start from your feet and move up to your face. This reduces physical tension and calms your mind.</p>
    </div>
  </div>

  <!-- THIS IS THE ONLY CHANGE -->
  <footer>¬© 2025 Breathe & Be. All rights reserved.</footer>
  
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut as firebaseSignOut } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";
    const firebaseConfig = {
      apiKey: "AIzaSyCaimG4cdtkGHWqYHn9fa5vpbfNGuffgSs",
      authDomain: "mental-health-app-5754d.firebaseapp.com",
      projectId: "mental-health-app-5754d",
      storageBucket: "mental-health-app-5754d.appspot.com",
      messagingSenderId: "772808891462",
      appId: "1:772808891462:web:07675a2895d0dd59f93e47"
    };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    onAuthStateChanged(auth, (user) => {
      if (user) {
        document.body.style.visibility = 'visible';
        document.getElementById('user-email-display').textContent = user.email;
        initPageFunctions();
      } else {
        window.location.href = 'login.html';
      }
    });

    const signOutButton = document.getElementById('sign-out-button');
    if(signOutButton) {
        signOutButton.addEventListener('click', (e) => {
            e.preventDefault();
            firebaseSignOut(auth).catch((error) => console.error("Sign out error", error));
        });
    }

    const profileButton = document.getElementById('profile-menu-button');
    const profileDropdown = document.getElementById('profile-menu-dropdown');
    if (profileButton && profileDropdown) {
        profileButton.addEventListener('click', (event) => {
            event.stopPropagation();
            profileDropdown.classList.toggle('show');
        });
    }
    window.addEventListener('click', (event) => {
        if (profileDropdown && profileDropdown.classList.contains('show')) {
            if (!profileButton.contains(event.target) && !profileDropdown.contains(event.target)) {
                profileDropdown.classList.remove('show');
            }
        }
    });
    
    function initPageFunctions() {
        const stressRating = document.getElementById('stressRating');
        const stressRatingValue = document.getElementById('stressRatingValue');
        const submitThoughtBtn = document.getElementById('submitThoughtBtn');
        const thoughtResult = document.getElementById('thoughtResult');
        const stressThought = document.getElementById('stressThought');
        if (!stressRating) return; 
        stressRating.addEventListener('input', () => {
            stressRatingValue.textContent = stressRating.value;
        });
        submitThoughtBtn.addEventListener('click', () => {
            const thought = stressThought.value.trim();
            const rating = Number(stressRating.value);
            thoughtResult.style.display = 'block'; 
            if (!thought) {
                thoughtResult.textContent = 'Please enter what is stressing you.';
                thoughtResult.style.color = '#d32f2f'; 
                return;
            }
            thoughtResult.style.color = '#004085';
            thoughtResult.innerHTML = `
                You identified your stressor as: <em>"${thought}"</em>.<br/>
                Your current stress level is <strong>${rating}/10</strong>.<br/>
                Take a moment to pause and breathe deeply. Notice if your stress changes as you become aware of it.
            `;
            clearAllIntervals();
            if (rating <= 3) {
                showAffirmation();
            } else if (rating <= 7) {
                startBoxBreathing();
            } else {
                startProgressiveMuscleRelaxation();
            }
        });
        let intervals = [];
        function clearAllIntervals() {
            intervals.forEach(id => clearInterval(id));
            intervals = [];
        }
        function showAffirmation() {
            const affirmBtn = document.createElement('button');
            affirmBtn.textContent = 'Show Positive Affirmation';
            affirmBtn.className = 'btn btn-primary'; 
            affirmBtn.style.width = 'auto'; 
            affirmBtn.onclick = () => {
                alert('You are doing great! Keep focusing on the positive things in your life. üíö');
            };
            thoughtResult.appendChild(document.createElement('br'));
            thoughtResult.appendChild(affirmBtn);
        }
        function startBoxBreathing() {
            const instructions = document.createElement('div');
            instructions.id = 'exerciseInstructions';
            thoughtResult.appendChild(instructions);
            let cycle = 0;
            const phases = [
                { text: 'Breathe In', seconds: 4 },
                { text: 'Hold Breath', seconds: 4 },
                { text: 'Breathe Out', seconds: 4 },
                { text: 'Hold Breath', seconds: 4 },
            ];
            let phaseIndex = 0;
            let secondsLeft = phases[phaseIndex].seconds;
            instructions.innerHTML = `<p id="countdown">${phases[phaseIndex].text}: ${secondsLeft}s</p>`;
            const countdownElem = document.getElementById('countdown');
            const intervalId = setInterval(() => {
                secondsLeft--;
                if (secondsLeft > 0) {
                    countdownElem.textContent = `${phases[phaseIndex].text}: ${secondsLeft}s`;
                } else {
                    phaseIndex++;
                    if (phaseIndex === phases.length) {
                        cycle++;
                        if (cycle === 4) {
                            clearInterval(intervalId);
                            countdownElem.textContent = 'Well done! You completed 4 cycles of box breathing.';
                            return;
                        }
                        phaseIndex = 0;
                    }
                    secondsLeft = phases[phaseIndex].seconds;
                    countdownElem.textContent = `${phases[phaseIndex].text}: ${secondsLeft}s`;
                }
            }, 1000);
            intervals.push(intervalId);
        }
        function startProgressiveMuscleRelaxation() {
            const muscleGroups = ['Feet', 'Calves', 'Thighs', 'Stomach', 'Chest', 'Hands', 'Arms', 'Shoulders', 'Neck', 'Face'];
            thoughtResult.innerHTML += '<div id="exerciseInstructions"></div>';
            const instructionsDiv = document.getElementById('exerciseInstructions');
            let currentGroup = 0;
            let state = 'tense'; 
            function showStep() {
                if (currentGroup >= muscleGroups.length) {
                    instructionsDiv.innerHTML = '<p>Great job! You have completed the progressive muscle relaxation.</p>';
                    return;
                }
                let actionText = state === 'tense' ? 'Tense' : 'Relax';
                let seconds = state === 'tense' ? 5 : 10;
                instructionsDiv.innerHTML = `<p>${actionText} your ${muscleGroups[currentGroup]} for ${seconds} seconds.</p><p id="countdown">${seconds}</p>`;
                const countdownElem = document.getElementById('countdown');
                let secLeft = seconds;
                const intervalId = setInterval(() => {
                    secLeft--;
                    if (secLeft > 0) {
                        countdownElem.textContent = secLeft;
                    } else {
                        clearInterval(intervalId);
                        intervals = intervals.filter(id => id !== intervalId);
                        if (state === 'tense') {
                            state = 'relax';
                        } else {
                            state = 'tense';
                            currentGroup++;
                        }
                        showStep();
                    }
                }, 1000);
                intervals.push(intervalId);
            }
            showStep();
        }
    }
  </script> 
</body> 
</html>